
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Fast simulation options Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="The Starterkit team and contributors">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-panels/panels.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex-auto-render/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="hlt-intro.html" />
    
    
    <link rel="prev" href="simulation-gencuts.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    The LHCb Starterkit
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../CONTRIBUTING.html">
            
                <a href="../CONTRIBUTING.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../first-analysis-steps/">
            
                <a href="../first-analysis-steps/">
            
                    
                    First analysis steps
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../first-analysis-steps/prerequisites.html">
            
                <a href="../first-analysis-steps/prerequisites.html">
            
                    
                    Pre-workshop checklist
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../first-analysis-steps/introduction-to-course.html">
            
                <a href="../first-analysis-steps/introduction-to-course.html">
            
                    
                    Goals of the course
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../first-analysis-steps/dataflow.html">
            
                <a href="../first-analysis-steps/dataflow.html">
            
                    
                    The LHCb data flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../first-analysis-steps/run-2-data-flow.html">
            
                <a href="../first-analysis-steps/run-2-data-flow.html">
            
                    
                    Changes to the data flow in Run 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="../first-analysis-steps/davinci.html">
            
                <a href="../first-analysis-steps/davinci.html">
            
                    
                    An introduction to LHCb Software
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="../first-analysis-steps/bookkeeping.html">
            
                <a href="../first-analysis-steps/bookkeeping.html">
            
                    
                    Finding data in the Bookkeeping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7" data-path="../first-analysis-steps/files-from-grid.html">
            
                <a href="../first-analysis-steps/files-from-grid.html">
            
                    
                    Downloading a file from the grid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8" data-path="../first-analysis-steps/interactive-dst.html">
            
                <a href="../first-analysis-steps/interactive-dst.html">
            
                    
                    Interactively exploring a DST
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.9" data-path="../first-analysis-steps/loki-functors.html">
            
                <a href="../first-analysis-steps/loki-functors.html">
            
                    
                    Fun with LoKi Functors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.10" data-path="../first-analysis-steps/minimal-dv-job.html">
            
                <a href="../first-analysis-steps/minimal-dv-job.html">
            
                    
                    Running a minimal DaVinci job locally
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.11" data-path="../first-analysis-steps/davinci-grid.html">
            
                <a href="../first-analysis-steps/davinci-grid.html">
            
                    
                    Running DaVinci on the grid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.12" data-path="../first-analysis-steps/add-tupletools.html">
            
                <a href="../first-analysis-steps/add-tupletools.html">
            
                    
                    TupleTools and branches
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.13" data-path="../first-analysis-steps/decay-tree-fitter.html">
            
                <a href="../first-analysis-steps/decay-tree-fitter.html">
            
                    
                    How do I use DecayTreeFitter?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.14" data-path="../first-analysis-steps/ganga-data.html">
            
                <a href="../first-analysis-steps/ganga-data.html">
            
                    
                    More Ganga
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.15" data-path="../first-analysis-steps/eos-storage.html">
            
                <a href="../first-analysis-steps/eos-storage.html">
            
                    
                    Storing large files on EOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.16" data-path="../first-analysis-steps/split-jobs.html">
            
                <a href="../first-analysis-steps/split-jobs.html">
            
                    
                    Splitting a job into subjobs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.17" data-path="../first-analysis-steps/lhcb-dev.html">
            
                <a href="../first-analysis-steps/lhcb-dev.html">
            
                    
                    Developing LHCb Software
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.18" data-path="../first-analysis-steps/asking-questions.html">
            
                <a href="../first-analysis-steps/asking-questions.html">
            
                    
                    Asking good questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.19" data-path="../first-analysis-steps/ecgd.html">
            
                <a href="../first-analysis-steps/ecgd.html">
            
                    
                    Early career, gender and diversity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.20" data-path="../first-analysis-steps/contributing-lesson.html">
            
                <a href="../first-analysis-steps/contributing-lesson.html">
            
                    
                    Contribute to this lesson
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="./">
            
                <a href="./">
            
                    
                    Second analysis steps
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="lb-git.html">
            
                <a href="lb-git.html">
            
                    
                    Using git to develop LHCb software
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="building-decays.html">
            
                <a href="building-decays.html">
            
                    
                    Building your own decay
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.2.1" data-path="building-decays-part0.html">
            
                <a href="building-decays-part0.html">
            
                    
                    The Selection Framework
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2.2" data-path="building-decays-part1.html">
            
                <a href="building-decays-part1.html">
            
                    
                    A Historical Approach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2.3" data-path="building-decays-part2.html">
            
                <a href="building-decays-part2.html">
            
                    
                    Modern Selection Framework
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="fixing-errors.html">
            
                <a href="fixing-errors.html">
            
                    
                    What to do when something fails
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="rerun-stripping.html">
            
                <a href="rerun-stripping.html">
            
                    
                    Run a different stripping line on simulated data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="switch-mass-hypo.html">
            
                <a href="switch-mass-hypo.html">
            
                    
                    Replace a mass hypothesis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.6" data-path="filter-in-trees.html">
            
                <a href="filter-in-trees.html">
            
                    
                    Reuse particles from a decay tree
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7" data-path="simulation.html">
            
                <a href="simulation.html">
            
                    
                    The simulation framework
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.7.1" data-path="simulation-intro.html">
            
                <a href="simulation-intro.html">
            
                    
                    Introduction: The basics of Gauss
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7.2" data-path="simulation-running-gauss.html">
            
                <a href="simulation-running-gauss.html">
            
                    
                    Getting the correct option files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7.3" data-path="simulation-dkfiles.html">
            
                <a href="simulation-dkfiles.html">
            
                    
                    Controlling the decay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7.4" data-path="simulation-advanced-dkfiles.html">
            
                <a href="simulation-advanced-dkfiles.html">
            
                    
                    Advanced: Controlling the decay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7.5" data-path="simulation-gencuts.html">
            
                <a href="simulation-gencuts.html">
            
                    
                    Modifying generator cuts
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.1.7.6" data-path="simulation-fastsim.html">
            
                <a href="simulation-fastsim.html">
            
                    
                    Fast simulation options
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.8" data-path="hlt-intro.html">
            
                <a href="hlt-intro.html">
            
                    
                    HLT intro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.9" data-path="tistos-diy.html">
            
                <a href="tistos-diy.html">
            
                    
                    TisTos DIY
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.10" data-path="ganga-scripting.html">
            
                <a href="ganga-scripting.html">
            
                    
                    Ganga Scripting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.11" data-path="managing-files-with-ganga.html">
            
                <a href="managing-files-with-ganga.html">
            
                    
                    Managing files in Ganga
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.12" data-path="analysis-automation-snakemake.html">
            
                <a href="analysis-automation-snakemake.html">
            
                    
                    Analysis automation: snakemake
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <a target="_blank" href="ref://starterkit-lessons.pdf">
            
                    
                    Download PDF
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Fast simulation options</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p><div class="panel panel-warning"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(3640333486);" id="learning-objectives"><i class="fa fa-line-chart"></i> Learning Objectives<span id="heading-3640333486"></span></h3></div><div class="panel-body" id="panel-3640333486"><ul>
<li>Learn about existing fast simulation options</li>
</ul>
</div></div> </p>
<h1 id="why-fast-simulation-is-crucial">Why fast simulation is crucial</h1>
<p>Our production queues are beyond full and nominal simulation for all requests is unsustainable for the future.
Using fast simulation or being smart about how you use simulated samples is unavoidable. Fortunately,
some fast simulation options already exist which are ready to be used and a very brief overview is given
below (excluding options still in development).</p>
<p>In general, Gauss is a very flexible and extensible framework and if you require a large simulated sample it is useful
to think about whether some change to the configuration, a reordering of steps or the event loop might net large
speed-ups basically for free.</p>
<h2 id="speeding-up-the-detector-simulation">Speeding up the detector simulation</h2>
<h3 id="reduced-detector-geometry">Reduced detector geometry</h3>
<p>It is possible to turn off parts of the detector that might not be necessary for the specific analysis.
Most prominently, the RICH detectors propagation of the optical photons can be deactivated which reduces
the overall time required to simulate an event by 30%. More aggressively, all but the tracking system can be turned of, netting an
increase in speed by about a factor of 10. However, the latter severely impacts the usability of the samples.</p>
<h3 id="particle-gun">Particle gun</h3>
<p>Instead of generating a full Pythia event, a single signal particle is spawned whose kinematics can be configured
to follow various different distribution (with distributions as in Pythia8 available). The particle is then decayed
using EvtGen to the desired final state. The overall increase in speed is about a factor of 50. However, resolutions and efficiencies
are usually too good (compared to the full simulation) as the detector occupancy is much lower.</p>
<h3 id="redecay">ReDecay</h3>
<p>Allows to re-use the underlying event but generates and simulates new signal decays every time. Depending on the studied signal decay multiplicity,
speed-ups by a factor between 10 and 20 are typically seen. Additionally, the same precision as in the nominal simulation is reached.
However, as the underlying event and the kinematics of the signal particle remain unchanged, correlations between different events are introduced whose
effect depends on the studied observables and need to be handled with care if significant.</p>
<h2 id="speeding-up-the-generation">Speeding up the generation</h2>
<h3 id="split-generator-level-cuts">Split generator level cuts</h3>
<p>Imagine you are studying the decay of a signal particle that is relatively rarely produced in Pythia 8 minimum bias events. In addition you apply tight generator level
cuts which do not depend on what Pythia did (i.e. Lorentz-invariant quantities such as some invariant mass combination of some children). We have the ability
to split the generator cuts: One part is applied as usual, triggering a reset of the generation phase if not passed. The other part is applied immediately after
EvtGen generated the signal decay. If the generated decay fails (e.g. the invariant mass combination of two children is below a threshold), the decay products are
removed and a new decay is generated until the cuts are passed. This avoids rerunning Pythia unnecessarily and can lead to substantial CPU savings when studying rare
particles (e.g. $$\Lambda_b$$).</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="simulation-gencuts.html" class="navigation navigation-prev " aria-label="Previous page: Modifying generator cuts">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="hlt-intro.html" class="navigation navigation-next " aria-label="Next page: HLT intro">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Fast simulation options","level":"3.1.7.6","depth":3,"next":{"title":"HLT intro","level":"3.1.8","depth":2,"path":"second-analysis-steps/hlt-intro.md","ref":"second-analysis-steps/hlt-intro.md","articles":[]},"previous":{"title":"Modifying generator cuts","level":"3.1.7.5","depth":3,"path":"second-analysis-steps/simulation-gencuts.md","ref":"second-analysis-steps/simulation-gencuts.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","panels@git+https://github.com/lhcb/gitbook-plugin-panels.git#master","katex-auto-render@git+https://github.com/lhcb/gitbook-plugin-katex-auto-render.git#master","collapsible-menu","otherlink"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"collapsible-menu":{},"search":{},"otherlink":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"panels":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"katex-auto-render":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"The Starterkit team and contributors","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"second-analysis-steps/simulation-fastsim.md","mtime":"2018-05-10T07:23:57.319Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-05-10T07:25:46.270Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-panels/panels.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-katex-auto-render/katex.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-katex-auto-render/auto-render.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-katex-auto-render/enable-auto-render.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-otherlink/js/otherlink.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

